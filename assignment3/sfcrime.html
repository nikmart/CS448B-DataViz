<!DOCTYPE html>
<meta charset="utf-8">
<style>

text {
  font: bold 48px monospace;
}

.enter {
  fill: green;
}

.update {
  fill: #333;
}

.chart div {
  font: 10px sans-serif;
  background-color: grey;
  text-align: right;
  padding: 3px;
  margin: 1px;
  color: white;
}

</style>
<body>

<script src="//d3js.org/d3.v3.min.js"></script>
<script>

//.............. SF MAP ............//
// Set up size
var width = 750,
	height = width;

// Set up projection that map is using
var projection = d3.geo.mercator()
	.center([-122.433701, 37.767683]) // San Francisco, roughly
	.scale(225000)
	.translate([width / 2, height / 2]);

// Add an svg element to the DOM
var svg = d3.select("body").append("svg")
	.attr("width", width)
	.attr("height", height);

// Add svg map at correct size, assumes map is saved in a subdirectory called "data"
svg.append("image")
          .attr("width", width)
          .attr("height", height)
          .attr("xlink:href", "data/sf-map.svg");
//..................................//

// var data = [[-122.458220811697, 37.7633123961354], [-122.447596140416, 37.7106886165247]]; //sample data
// console.log(data[1] + ", " + data[0]);

var crimes;

d3.json("data/scpd_incidents.json", function(error, json) {
  if (error) return console.warn(error);
  crimes = json;
  //console.log(json);
  mapIt(crimes);
});

function mapIt(data) {
  // put points down where the crimes happened using the data locations
  // add circles to svg
  //console.log(data.data);
  svg.selectAll("circle")
      .data(data.data).enter()
  		.append("circle")
  		.attr("cx", function (d) { return projection(d.Location)[0]; })
  		.attr("cy", function (d) { return projection(d.Location)[1]; })
  		.attr("r", "2px")
  		.attr("fill", "red");
};


// References
  // Plotting a point on a map: http://bl.ocks.org/phil-pedruco/7745589

</script>
</body>
